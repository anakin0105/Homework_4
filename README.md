# Homework_4
Модуль 4: Объектно-ориентированное программирование
## Описание
Это учебный проект товары. Реализованы функции для чтения JSON-файла и Классы Product и Category

```plaintext
├── src/                    # Основные исходные файлы
│   ├──__init__.py
│   ├── catigory_class.py   # Класс Category с атрибутом: название, описание, лист продуктов, 
│   │                         количество категорий, количество товаров.
│   ├── exeption.py         # Класс исключения ZeroQuantityError
│   ├── oder.py             # Класс Order с атрибутом: название, описание, продукт, количество
│   ├── product_class.py    # Класс Product с атрибутом: название, описание, цена, количество.
│   ├── utils.py            # Функция для чтения JSON-файла
├── tests/                  # Тесты проекта
├── main.py                 # Точка входа в приложение
├── poetry.lock             # Файл блокировки зависимостей
├── pyproject.toml          # Конфигурация проекта для Poetry
```
### Модули и функции
#### 1. Модуль Product_class.py
- **Класс**: `class Product`
  - **Описание**: Класс `Product` представляет продукт с атрибутами: название, описание, цена и количество. Используется для создания объектов, содержащих информацию о товаре.
  - **Параметры**:
    - `name: str` — Название продукта.
    - `description: str` — Описание продукта.
    - `price: float` — Цена продукта.
    - `quantity: int` — Количество продукта на складе.
  - **Возвращает**: Экземпляр класса `Product` с заданными атрибутами.


#### 2. Модуль Category_class.py
- **Класс**: `class Category`
  - **Описание**: Класс `Category` представляет категорию товаров с атрибутами: название, описание, список продуктов, а также счётчики общего количества категорий и продуктов. Используется для организации продуктов в категории и подсчёта их количества.
  - **Параметры**:
    - `name: str` — Название категории.
    - `description: str` — Описание категории.
    - `products: list` — Список объектов `Product`, входящих в категорию.
    - `category_count: int` — Статический атрибут, хранящий общее количество созданных категорий (увеличивается при создании экземпляра).
    - `product_count: int` — Статический атрибут, хранящий общее количество продуктов во всех категориях (увеличивается на длину списка `products` при создании экземпляра).
  - **Возвращает**: Экземпляр класса `Category` с заданными атрибутами и обновлёнными счётчиками категорий и продуктов.
 

#### 3. Модуль <имя_модуля>.py
- **Функция**: `read_json_file`
  - **Описание**: Читает данные из JSON-файла по указанному пути и возвращает список словарей с информацией о продуктах и категориях. Обрабатывает возможные ошибки, такие как отсутствие файла, некорректный JSON или пустой список, выводя соответствующие сообщения в консоль.
  - **Параметры**:
    - `path: str` — Путь к JSON-файлу, содержащему данные о продуктах и категориях.
  - **Возвращает**: Список словарей с данными из JSON-файла. Если файл не найден, содержит некорректные данные, пуст или не является списком, возвращает пустой список (`[]`) и выводит сообщение об ошибке в консоль.
  
## Выполненные задачи
задания 14.2, включая дополнительные задания 3 и 4:

1. **Класс Product**:
 Атрибутыты**:
     - name (str): Название товара.
     - description (str): Описание товара.
     - __price (float, приватный): Цена товара, доступна только через геттер и сеттер.
     - quantity (int): Количество товара на складе.
 Методыды**:
     - __init__: Инициализирует товар с названием, описанием, ценой и количеством.
     - new_product (класс-метод): Создаёт товар из словаря с атрибутами.
     - price (геттер): Возвращает приватный атрибут __price.
     - price (сеттер, дополнительное задание 4): Обновляет цену с валидацией:
       - Запрещает нулевые или отрицательные цены с сообщением: "Цена не должна быть нулевая или отрицательная".
       - Запрашивает подтверждение (y/n) при понижении цены, отменяя изменение, если введено не y.

2. **Класс Category*Атрибутырибуты**:
     - name (str): Название категории.
     - description (str): Описание категории.
     - __products (list, приватный): Список объектов Product, доступен только через геттер.
     - category_count (класс-атрибут): Считает общее количество категорий.
     - product_count (класс-атрибут): Считает общее количество товаров во всех категорияМетодыМетоды**:
     - __init__: Инициализирует категорию с названием, описанием и списком товаров, обновляя category_count и product_count.
     - products (геттер): Возвращает строку с товарами в формате: "Название, X руб. Остаток: Y шт.\n".
     - add_product: Добавляет товар в __products с валидацией:
       - Проверяет, что входной параметр — объект Product, иначе вызывает ValueError.
 Дополнительное задание 3ание 3**: Проверяет дубликаты по имени:
         - При совпадении имени суммирует количество и выбирает более высокую цену (используя сеттер price).
         - Если дубликата нет, добавляет товар и увеличивает product_count.

3. **Тесты**:
   - Реализованы в tests/test_main.py с использованием pytest и фикстур.
   - Покрывают:
     - Инициализацию Product и Category.
     - Класс-метод new_product.
     - Геттер и сеттер price (повышение, понижение с подтверждением/отказом, невалидная цена).
     - Геттер products.
     - Метод add_product (уникальные товары, дубликаты с разными ценами, неверный тип).
     - Приватность атрибутов __price и __products.
   - Покрытие тестами >75%, проверено с помощью pytest-cov.
## Установка и запуск тестов
Установка зависимостей:
```bash
   pip install pytest pytest-cov
pytest tests --cov=src --cov-report=html -v
```
Задания 15.1:
### Задание 1: Строковое представление классов

- **Класс `Product`:**
  Добавлено строковое представление для объектов класса `Product` с помощью метода `__str__`. Формат вывода:

Количество продуктов вычисляется как сумма значений атрибута количества всех продуктов в категории. Оптимизирован геттер для списка товаров, который теперь использует строковое представление объектов `Product`.

### Задание 2: Сложение продуктов

Реализована возможность сложения объектов класса `Product` с помощью метода `__add__`. При сложении двух продуктов возвращается общая стоимость всех товаров на складе, рассчитанная как:цена_товара_a × количество_товара_a + цена_товара_b × количество_товара_b
### Задание 3: Тестирование

Добавлены тесты с использованием библиотеки `pytest` для проверки новой функциональности:
- Тесты для строкового представления классов `Product` и `Category`.
- Тесты для метода сложения `__add__` в классе `Product`.
- Убедились, что ранее написанные тесты продолжают выполняться без ошибок.

Тесты используют утверждения `assert` для проверки корректности работы методов.

### Дополнительное задание: Итератор для категории

Создан вспомогательный класс `CategoryIterator`, который позволяет перебирать товары в объекте класса `Category` в цикле `for`. Класс реализует методы `__iter__` и `__next__` для выполнения итерации по списку товаров категории.

Пример использования:
```python
category = Category("Электроника", [product1, product2])
for product in CategoryIterator(category):
    print(product)
```

Задания 16.1:

## Задание 1: Создание классов `Smartphone` и `LawnGrass`

Создайте два класса-наследника от базового класса `Product`:

- **Smartphone**:
  - Свойства: `name`, `description`, `price`, `quantity`, `efficiency`, `model`, `memory`, `color`.
  - Наследуется от `Product`.
- **LawnGrass**:
  - Свойства: `name`, `description`, `price`, `quantity`, `country`, `germination_period`, `color`.
  - Наследуется от `Product`.

Реализация выполнена с использованием наследования и метода `__init__` для инициализации свойств.

## Задание 2: Реализация метода `__add__` с проверкой типов

Доработан метод `__add__` для классов `Smartphone` и `LawnGrass`, чтобы складывать только объекты одного класса. Если типы объектов различаются, вызывается исключение `TypeError`.

## Задание 3: Защита метода добавления в категорию

Метод добавления продуктов в категорию доработан с 
использованием функций `isinstance` и `issubclass`, чтобы разрешать 
добавление только объектов классов `Product` или его наследников 
(`Smartphone`, `LawnGrass`).

        
## Задание 4: Написание тестов с использованием pytest
Созданы тесты для проверки новой функциональности с использованием библиотеки `pytest`. Тесты проверяют:
- Корректность создания объектов `Smartphone` и `LawnGrass`.
- Работу метода `__add__` для одинаковых классов и вызов `TypeError` для разных классов.
- Работу метода `add_product` в классе `Category` и вызов `TypeError` для некорректных объектов.
- Совместимость с ранее написанными тестами.


### Инструкции для запуска тестов
1. Убедитесь, что у вас установлена библиотека `pytest`:
   ```bash
   pip install pytest
   ```
2. Сохраните код классов в файл, например, `store.py`.
3. Сохраните тесты в файл, например, `test_store.py`.
4. Запустите тесты командой:
   ```bash
   pytest test_store.py -v
   ```

Тесты проверяют корректность создания объектов, логику сложения товаров и 
защиту метода добавления в категорию, обеспечивая отсутствие ошибок в ранее 
написанных тестах.

Задание 16.2: Новые изменения

## Домашнее задание 16.2: Новые изменения

- Реализован абстрактный класс `BaseProduct` в `product.py`, который определяет общую функциональность для классов продуктов (`Product`, `Smartphone`, `LawnGrass`).
- Добавлен миксин `PrintInitMixin` в `product.py` для вывода информации о создании объектов классов `Product`, `Smartphone` и `LawnGrass` (название класса и параметры `__init__`).
- Исправлен вывод миксина `PrintInitMixin`, чтобы корректно обрабатывать строковые аргументы с кавычками, используя `repr(args)`.

# Домашнее задание 17.1: Обработка исключений и тестирование в проекте магазина

## Описание проекта
Этот проект представляет собой систему управления товарами и категориями для интернет-магазина. В рамках домашнего задания 17.1 были реализованы новые функции, связанные с обработкой исключений, подсчётом средней цены и тестированием.

## Условия домашнего задания
Работа выполнена в рамках существующего проекта. Добавлены следующие функциональности:

### Задание 1: Обработка нулевого количества в `Product`
- В метод `__init__` класса `Product` добавлена проверка количества товара.
- При попытке создать товар с нулевым или отрицательным количеством выбрасывается исключение `ValueError` с сообщением: «Товар с нулевым количеством не может быть добавлен».

### Задание 2: Метод средней цены в `Category`
- В класс `Category` добавлен метод `average_price`, который вычисляет среднюю цену всех товаров в категории.
- Обрабатывается случай, когда категория пуста (деление на ноль), с возвратом `0`.

### Задание 3: Тестирование
- Написаны тесты для новой функциональности:
  - Проверка `ValueError` при создании товара с нулевым количеством.
  - Проверка метода `average_price` для категорий с товарами и пустых категорий.
- Покрытие тестами функционального кода >75% (проверено с помощью `pytest --cov`).
- Существующие тесты работают без ошибок.

### Дополнительное задание: Пользовательское исключение
- Создан класс `ZeroQuantityError` для обработки случаев, когда в `Category` или `Order` добавляется товар с нулевым количеством.
- Реализован метод `add_product` в `Category` и обновлён `__init__` в `Order` с использованием `try/except/else/finally`:
  - При успешном добавлении выводится сообщение: «Товар {name} добавлен».
  - При ошибке выводится сообщение об ошибке.
  - В любом случае выводится: «Обработка добавления товара завершена».

## Критерии оценки
- **Инициализация экземпляра класса**:
  - Проверка нулевого количества в `Product.__init__` реализована.
  - Выбрасывается `ValueError` с правильным сообщением.
- **Метод средней цены**:
  - Метод `average_price` в `Category` корректно считает среднюю цену.
  - Обрабатывает случай пустой категории (возвращает `0`).
- **Тестирование**:
  - Добавлены тесты для новой функциональности.
  - Покрытие >75%, отчёт доступен в `htmlcov/`.
  - Все тесты проходят без ошибок.

## Изменённые файлы
- `src/product.py`: Добавлена проверка нулевого количества в `__init__`.
- `src/category.py`: Добавлен метод `average_price` и `add_product` (для доп. задания).
- `src/order.py`: Обновлён `__init__` для обработки `ZeroQuantityError`.
- `src/exceptions.py`: Новый файл с классом `ZeroQuantityError`.
- `tests/test_product.py`: Добавлен тест для проверки `ValueError`.
- `tests/test_category.py`: Добавлены тесты для `average_price` и `add_product`.
- `tests/test_order.py`: Добавлен тест для проверки `ZeroQuantityError`.
- `main.py`: Обновлён для использования `average_price` и тестирования исключений.

## Как запустить
1. Установите зависимости:
   ```bash
   pip install pytest pytest-cov
   ```
2. Запустите тесты:
   ```bash
   pytest tests/test_product.py tests/test_category.py tests/test_order.py
   ```
3. Проверьте покрытие тестами:
   ```bash
   pytest --cov=src --cov-report=html
   ```
4. Запустите основной скрипт:
   ```bash
   python main.py
   ```